// Get the status and vulnerabilities elements from the popup
const statusElement = document.getElementById("status");
const vulnerabilitiesElement = document.getElementById("vulnerabilities");

// Load the vulnerabilities from storage and update the popup
chrome.storage.local.get("vulnerabilities", (data) => {
  const vulnerabilities = data.vulnerabilities || [];
  if (vulnerabilities.length > 0) {
    statusElement.textContent = "Vulnerabilities detected!";
    vulnerabilities.forEach((vulnerability) => {
      const listItem = document.createElement("li");
      listItem.textContent = vulnerability;
      vulnerabilitiesElement.appendChild(listItem);
    });
  } else {
    statusElement.textContent = "No vulnerabilities detected.";
  }
});

// Listen for the popup to open and request a scan from the background script
document.addEventListener("DOMContentLoaded", () => {
  chrome.runtime.sendMessage({ action: "scan" });
});
